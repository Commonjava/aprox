<?xml version="1.0" encoding="UTF-8"?>
<infinispan xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="urn:infinispan:config:9.1 http://www.infinispan.org/schemas/infinispan-config-9.1.xsd"
            xmlns="urn:infinispan:config:9.1">

  <cache-container default-cache="local" name="IndyCacheManager" shutdown-hook="DEFAULT" statistics="true">
    <local-cache-configuration name="local-template" statistics="true">
      <!-- eviction is DEPRECATED, use memory element instead -->
      <memory>
        <!--
          Limits the cache to this by the amount of entries in the cache.
          If choose memory or off-heap, make sure the key/value objects implements Serializable
        -->
        <object size="200000"/>
      </memory>
    </local-cache-configuration>

    <local-cache name="local" configuration="local-template"/>

    <local-cache name="koji-maven-version-metadata" configuration="local-template"/>

    <local-cache name="folo-in-progress" configuration="local-template">
      <indexing index="LOCAL">
        <property name="hibernate.search.model_mapping">org.commonjava.indy.folo.data.FoloCacheProducer</property>
        <property name="default.directory_provider">ram</property>
      </indexing>
    </local-cache>

    <local-cache name="folo-sealed" configuration="local-template">
      <memory>
        <object size="1000"/>
      </memory>
      <persistence passivation="true">
        <file-store shared="false" preload="false" fetch-state="true" path="${indy.data}/folo"/>
      </persistence>
    </local-cache>

    <local-cache name="content-metadata" configuration="local-template"/>

    <local-cache name="content-index" configuration="local-template"/>

    <local-cache name="maven-version-metadata-cache" deadlock-detection-spin="10000" configuration="local-template">
      <memory>
        <object size="10000000"/>
      </memory>
    </local-cache>

    <local-cache name="indy-nfs-owner-cache" deadlock-detection-spin="10000" configuration="local-template">
      <transaction protocol="DEFAULT" transaction-manager-lookup="org.infinispan.transaction.lookup.DummyTransactionManagerLookup" locking="PESSIMISTIC"/>
    </local-cache>

    <local-cache name="indy-fastlocal-file-delete-cache" configuration="local-template">
      <!--
        Delete the fast local cache entries. It expires entries in 1 day and run expiration every 30 minutes.
      -->
      <expiration lifespan="86400000" max-idle="86400000" interval="1800000"/>
    </local-cache>

    <local-cache name="schedule-expire-cache" configuration="local-template">
      <expiration interval="300" />
    </local-cache>

    <local-cache name="nfc" configuration="local-template">
      <!--
        Delete NFC cache entries. It expires entries in 1 hour and run expiration every 15 minutes.
      -->
      <expiration lifespan="3600000" max-idle="3600000" interval="900000" />
      <indexing index="LOCAL">
        <property name="default.directory_provider">ram</property>
      </indexing>
    </local-cache>

  </cache-container>
</infinispan>
