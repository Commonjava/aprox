<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <script type="text/javascript">
    var base='http://localhost:9080/aprox/api/1.0/repository/';
    var repoTable;
    
    function renderAProxUrl( name ){
      return '<a target="_new" href="' + base + name + '">' + base + name + '</a>';
    }
    
    function renderRemoteUrl( url ){
      return '<a target="_new" href="' + url + '">' + url + '</a>';
    }
    
    $(document).ready(function()
    {
      repoTable = $("#repo-panel .listing-table").dataTable({
        "bProcessing": true,
        "sAjaxSource": "http://localhost:9080/aprox/api/1.0/admin/repository/list",
        "sAjaxDataProp": "items",
        "aoColumns": [
          {
            "sTitle": "Repository Name",
            "bSortable": true,
            "mDataProp": "name",
          },
          {
            "sTitle": "AProx URL",
            "bSortable": true,
            "bUseRendered":false,
            "fnRender": function(o,data){return renderAProxUrl(data);},
            "sWidth": "500px",
            "mDataProp": "name",
          },
          {
            "sTitle": "Remote URL",
            "bSortable": true,
            "bUseRendered":false,
            "fnRender": function(o,data){return renderRemoteUrl(data);},
            "sWidth": "500px",
            "mDataProp": "url",
          },
          {
            "sTitle": "Timeout",
            "mDataProp": "timeout_seconds"
          },
        ],
      });
    });
    
    $('#create-repo').click(function()
    {
      var name = $('#new-repo-name').val();
      var url = $('#new-repo-url').val();
      var timeout = $('#new-repo-timeout').val();
      repoTable.fnAddData({
        "name": name,
        "url": url,
        "timeout_seconds": timeout,
      });
    });
    </script>
  </head>
  <body>
    <div id="repo-panel" class="content-pane">
      <div class="content-pane-controls">
        <input type="button" name="save-repos" value="Save Changes" enabled="false" />
        <input type="button" name="reset-repos" value="Discard Changes" enabled="false" />
      </div>
      <div class="existing-listing">
        <table class="listing-table" border="1">
          <tr>
            <th>Repository Name</th>
            <th>Local URL</th>
            <th>Remote URL</th>
            <th>Extra Attributes</th>
            <th>Controls</th>
          </tr>
        </table>
      </div>
      <div class="new-item">
        <form target="#add-repo">
          <div class="form-line">
            Repository Name: <input type="text" id="new-repo-name" size="15" />
          </div>
          <div class="form-line">
            Remote URL: <input type="text" id="new-repo-url" size="45" />
          </div>
          <div class="form-line">
            Timeout (seconds): <input type="text" id="new-repo-timeout" size="3" />
          </div>
          <div class="form-line form-controls">
            <input type="button" id="create-repo" value="Create" />
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
